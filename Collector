import time                     
from pathlib import Path        

FOLLOW_FILES  = [ "/var/log/auth.log", "/var/log/syslog", ]

OUT_DIR = Path("/loganalyzer/raw_logs")

def follow (file_path, out_file):
        with open(file_path, "r") as f:
               
                f.seek(0,2) 
                while True:
                        line = f.readline()
                        if not line:
                                time.sleep(0.1)
                                continue
                        out_file.write(line)
                        out_file.flush()

def main():
        import threading         
        threads =[]
        for src in FOLLOW_FILES:
                dest = OUT_DIR / (Path(src).name + ".in")
                f_out = open(dest, "a")
                t = threading.Thread(target=follow, args=(src, f_out), daemon =True)
                t.start()          
                threads.append(t)  
        while True:
                time.sleep(1)

if __name__ == "__main__":
        main()

