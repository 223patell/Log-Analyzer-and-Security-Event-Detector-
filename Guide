def guide_bruteforce(conn, threshold=1):
   
    cur = conn.cursor()

    cur.execute("""
        SELECT src_ip, user, COUNT(*) AS c
        FROM events
        WHERE event_type = 'auth_failed'
        GROUP BY src_ip, user
    """)

    rows = cur.fetchall()

    alerts = []

    for ip, user, count in rows:
        
        if count >= threshold:
            alerts.append({
                "alert_type": "bruteforce",      # What type of alert this is
                "severity": "HIGH",              # Severity level
                "details": f"{count} failed SSH logins for user {user} from {ip}", 
            })

    return alerts
